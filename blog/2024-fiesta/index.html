<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>2024 FIESTA writeup</title><meta content="2024 FIESTA writeup" name=title><meta content=Catry name=author><meta content=website property=og:type><meta content=https://kafu.dev/blog/2024-fiesta/ property=og:url><meta property=og:site_name><meta content="2024 FIESTA writeup" property=og:title><meta content=summary_large_image property=twitter:card><meta content=https://kafu.dev/blog/2024-fiesta/ property=twitter:url><meta content="2024 FIESTA writeup" property=twitter:title><link href=https://kafu.dev/blog/2024-fiesta/ rel=canonical><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://kafu.dev/css/style.css rel=stylesheet><link as=style crossorigin href=https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.min.css rel=stylesheet><style>main{font-family:Pretendard Variable,Pretendard,-apple-system,BlinkMacSystemFont,system-ui,Roboto,Helvetica Neue,Segoe UI,Apple SD Gothic Neo,Noto Sans KR,Malgun Gothic,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,sans-serif}blockquote{margin:0 0 0 1.25rem;padding:0 0 0 .5rem;border-inline-start:.375rem solid var(--accent);font-style:italic}</style><script defer src=https://kafu.dev/js/script.js></script><body><header><nav id=nav-bar><a href=/> /home/ </a><a href=/about> /about/ </a><a href=/journal> /journal/ </a><a href=/blog> /blog/ </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://kafu.dev/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://kafu.dev/click.ogg type=audio/ogg></audio></div></nav></header><main><h1>2024 FIESTA writeup</h1><h2>Table of contents</h2><ul><li><a href=https://kafu.dev/blog/2024-fiesta/#sinario-s-3-1>시나리오 S-3-1</a><li><a href=https://kafu.dev/blog/2024-fiesta/#teugbbyeomunje-5>특별문제 5</a></ul><p>2025년이 되고나서 이제야 라이트업 관련 글을 써보게 되었습니다.<p>물론 제가 풀고 기억나는 문제 풀이 위주로 작성합니다.<h3 id=sinario-s-3-1>시나리오 S-3-1</h3><p>악성 <code>base.apk</code>가 있는 폴더 이름이 곧 flag 값인 문제였습니다.<p>userdata.img.zip 압축해제 한 후에 FTK Imager로 userdata.img 파일을 열어서 설치한 앱들을 확인합니다.<div><img alt="시나리오 S-3-1 사진" src=/2024-fiesta-01.png></div><ul><li>팁: flag는 악성 앱의 base.apk가 위치한 디렉토리(PATH)이고, 이미지가 제공하는 파일 시스템의 시작 Directory를 ‘/’(Root Directory)로 표시함.</ul><p>악성 앱인 <code>base.apk</code>의 위치임으로, <code>base.apk</code>가 들어가 있는 폴더들로 찾아냈습니다.<pre class=language-txt data-lang=txt style=background:#282828;color:#fdf4c1aa><code class=language-txt data-lang=txt><span>/app/~~rrdAAE9SiSKltgpBnW_FwA==/com.simplemobiletools.notes.pro-mL_UcEOVxaoxPoF6xI20FQ==
</span><span>
</span><span>/app/~~5Le_Z5PaiCzb2G-6cp2QEQ==/com.darkempire78.opencalculator-P8MQfBWzR7sspoPRY5uWOQ==
</span><span>
</span><span>/app/~~Ta2I_Ey8SINy_zOvKquX2A==/com.a.weather-rngH_0aMOfEpM0T9CeBeig==
</span></code></pre><p>그러나 3가지의 <code>base.apk</code>가 존재함으로 악성인 것을 걸려야 하는데, VirusTotal 힘을 빌려서 간략하게 확인했습니다.<ul><li><a href=https://www.virustotal.com/gui/file/5b47f40cf7c82cb5c7086f63566e13d8040141f523bcc1e4e1d6cfe3e1a16689/details rel=noopener target=_blank>https://www.virustotal.com/gui/file/5b47f40cf7c82cb5c7086f63566e13d8040141f523bcc1e4e1d6cfe3e1a16689/details</a></ul><p>세 번째 앱이 40개 중에 1개로 악성으로 잡혀서 <code>/app/~~Ta2I_Ey8SINy_zOvKquX2A==/com.a.weather-rngH_0aMOfEpM0T9CeBeig==</code>로 확인했습니다.<p>FLAG: <strong>FIESTA{/app/~~Ta2I_Ey8SINy_zOvKquX2A==/com.a.weather-rngH_0aMOfEpM0T9CeBeig==}</strong><h3 id=teugbbyeomunje-5>특별문제 5</h3><p>이 문제에서는 AI의 Prompt를 활용하여 FLAG 얻어오는 문제입니다. 특히나 제가 5분만에 문제를 풀어서 기억나는 문제입니다. ㅋㅋㅋ<div><img alt="특별문제 5" src=/2024-fiesta-02.png></div><p>환경 변수에 저장되어 있는 flag 변수를 가지고 오는 방법이 필요합니다. 이 과정 중에서는 1-day인 <strong><a href=https://nvd.nist.gov/vuln/detail/CVE-2023-29374 rel=noopener target=_blank>CVE-2023-29374</a></strong> 활용하면, 바로 flag를 가지고 올 수 있습니다.<p>FLAG: <strong>FIESTA{efbed7ab20801d732e6964be653729df2f4b660bb140d09615f1417948c59e71}</strong><p>더 문제를 푼 것들로 있지만, 자료를 모아놓지도 않았고, 따로 작성한 문서도 없어서 제가 푼 거 중에 기억나는 문제들로 writeup을 작성했습니다.<p>많이 푼 만큼 아쉬웠던 대회였지만, 좋은 팀원들을 만나서 <strong>139팀에서 20등</strong>로 최종 마무리했습니다.<p>이틀간 열심히 달려온 팀원분들께 감사인사를 올리면서 이 글을 마치겠습니다. 감사합니다.<div><img alt=결과 src=/2024-fiesta-result.png></div><p class=tags-data><a href=/tags/writeup>/writeup/</a> <a href=/tags/ctf>/ctf/</a> <a href=/tags/2024>/2024/</a></main><footer><hr><div id=footer-container><div>Except where otherwise noted, content on this site is licensed under a <a rel="noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/2.0/kr/ target=_blank>CC BY-NC-SA 2.0 KR</a> license.</div><div><p>Theme and color theme licensed under <a rel="noopener noreferrer" href=https://en.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a>.<br> Built with <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> theme, <a rel="noopener noreferrer" href=https://speyll.github.io/suCSS/ target=_blank>suCSS</a> framework & <a rel="noopener noreferrer" href=https://github.com/Speyll/veqev target=_blank>veqev</a>.<br></div></div></footer>